{% extends 'base.html' %}
{% load static %}

{% block css %}
<link rel="stylesheet" src="{% static 'css/owl.carousel.min.js'%}">
<style>
	

</style>
{% endblock %}



{% block content %}
<!-- <div style="background: orange" class="d-flex justify-content-between">
	<div class="col-2 mb-2 p-2">
		<input type="text" class="repinput form-control" style="border-radius: 3em;height: 40px;" placeholder="Recherche REPEXPERT" onchange="searchrepexpert()">
	
		<img src="/media/repxpert.svg" class="btn text-white mt-2" onclick="searchrepexpert()" style="width: 14em">
	</div>

	<div class="row" style="width: 60%;">
			{% for i in arrivage %}
			<a href="/newarrivage?info={{i.info}}" class="col-6 mt-2 mb-2" id="{{i.id}}" >
					<img src="{% if i.image%} {{i.image.url}} {% endif %}" alt="" class="rounded" style="width:100%;"/>
				</a>
			{% endfor %}
	</div>

	<div class="col-2 mb-2 p-2 me-5 text-center">
		<input type="text" class="vinrepinput form-control" style="border-radius: 3em;height: 40px;" placeholder="W0LGM6EJ0B1071492" onchange="searchvinrepexpert()">
		<button class="btn bg-darkblue rounded text-white w-100 mt-2 " onclick="searchvinrepexpert()">
			Recherche
		</button>
		<strong>
			Recherche par CARTE GRISE
		</strong>
	</div>
	
</div> -->
<div class="owl-carousel mt-3 px-5">
	{% for i in promotions %}
	<img src="{{i.image.url}}" alt="">
	{% endfor %}
</div>
<div class="position-relative " style="margin: 10px 5em;">
	<div class="page home-page bg-darkblue" style="height:80vh; overflow:scroll;">
		<div class="page-contents">
		  <div class="categories-list categories-list--layout--columns-4-sidebar">
		  <input type="text" class="searchboxctg form-control mt-2 mb-2 shadow"  placeholder="Chercher les categories..." >
		  <ul class="categories-list__body" style="height:77vh; overflow:scroll;">
		  {% for i in categories %}
		  {% if user.groups.all.0.name == 'clients' %}
		  {% if not i.masqueclients %}
		  <li class="categories-list__item ctgcards">
			  <a href="/categories/products/{{i.id}}">
				<div class="image image--type--category">
				  <div class="image__body">
					  {% if i.image %}
					<img class="image__tag" src="{{i.image.url}}" alt="">
					  {% endif %}
				  </div>
				</div>
				<div class="categories-list__item-name">{{i.name}}</div>
			  </a>
			  <!-- conmmenting because the number includes also inactive products -->
			  <div class="categories-list__item-products">{{i.total_products}} Products</div>
		  </li>
		  {% endif %}
		  {% elif user.groups.all.0.name == 'salsemen' %}
		  
			  {% if not request.user.represent in i.excludedrep.all %}
				  <li class="categories-list__item ctgcards">
					  <a href="/categories/products/{{i.id}}">
						<div class="image image--type--category">
						  <div class="image__body">
							  {% if i.image %}
									<img class="image__tag" src="{{i.image.url}}" alt="">
							  {% endif %}
						  </div>
						</div>
						<div class="categories-list__item-name">{{i.name}}</div>
					  </a>
					  <div class="categories-list__item-products">{{i.total_products}} Products</div>
				  </li>
			  {% endif %}
		  {% else %}
		  <li class="categories-list__item ctgcards">
			  <a href="/categories/products/{{i.id}}">
				<div class="image image--type--category">
				  <div class="image__body">
					  {% if i.image %}
					<img class="image__tag" src="{{i.image.url}}" alt="">
					  {% endif %}
				  </div>
				</div>
				<div class="categories-list__item-name">{{i.name}}</div>
			  </a>
			  <div class="categories-list__item-products">{{i.total_products}} Products</div>
		  </li>
		  {% endif %}
		  {% endfor %}
		  </ul>
		</div>
		</div>
	</div>
</div>
	<!-- products holder -->






{% endblock %}

{% block js %}

<script src="{% static 'js/catalog.js' %} "></script>

<script src="{% static 'js/owl.min.js'%}"></script>
<script>
	$(document).ready(function(){
    
	$(".owl-carousel").owlCarousel({
		center: true,
            loop:true,
            margin:30,
            nav:false,
            dots:true,
            autoplay: true,
            slideTransition: 'linear',
            autoplayTimeout: 3000,
            autoplaySpeed: 3000,
            autoplayHoverPause: true,
            responsive:{
                0:{
                    items:1
                },
                600:{
                    items:5
                },
                1000:{
                    items:5
                }
            }
	})
	$(".arrivage-carousel").owlCarousel({
		nav:false,
		dots:false,
		autoplay: true,
		items:1,
		loop:true,
	});
	})
	$('.searchinputcategories').on('input', function() {
         var filter = $(this).val().toUpperCase();
         $('.ctglist').each(function() {
            var categoryName = $(this).text().toUpperCase();
            if (categoryName.indexOf(filter) > -1) {
               $(this).show();
            } else {
               $(this).hide();
            }
         });
      });
	$('.searchinputmarks').on('input', function() {
         var filter = $(this).val().toUpperCase();
         $('.mrklist').each(function() {
            var categoryName = $(this).text().toUpperCase();
            if (categoryName.indexOf(filter) > -1) {
               $(this).show();
            } else {
               $(this).hide();
            }
         });
      });
	// $('.searchpc').on('change', ()=>{
	// 	var searchpc = $('.searchpc').val()
	// 	if(searchpc.length > 0){
	// 		$.get('/client/searchglobal', {term: searchpc}, (data)=>{
	// 			$('.searchresults').html(data.html)
	// 			$('.cmnd').each((i, el)=>{
	// 				$(el).on('click', ()=>{
	// 					// id=$(el).attr('pdct');
	// 					$(el).addClass('d-none')
	// 					$(el).parent().find('.anullercmnd').removeClass('d-none')
	// 					$(el).attr('disabled', true)
	// 					ref=$(el).attr('pdctref')
	// 					name=$(el).attr('pdctname')
	// 					ctg=$(el).attr('pdctcategory')
	// 					pr=$(el).attr('pdctpr')
	// 					id=$(el).attr('pdctid')
	// 					img=$(el).attr('pdctimg')
	// 					//min is remise
	// 					min=$(el).attr('pdctremise')
	// 					// get nearest item
	// 					let qty = $(el).parent().find('.input-number > .input-number__input').val()
	// 					// add new row to coommand table
	// 					addcmnd(name, ctg, ref, qty, pr, id, img, min)
	// 					// update total

	// 				})
	// 			})
	// 		})
	// 	} else {
	// 		$('.searchresults').html('')
	// 	}
	// })
	
	function searchrepexpert(){
		let inpval=$('.repinput').val()
		if (inpval==''){
			return
		}
		let url='https://www.repxpert.ma/fr/search/results?q='+inpval
		window.open(url, '_blank')
		
	}
	function searchvinrepexpert(){
		let inpval=$('.vinrepinput').val()
		if (inpval==''){
			return
		}
		//let url='https://auto3n.ru/catalogs/-vehicles?ident_string='+inpval+'&ft=findVehicle&c='
		let url='https://www.parts-catalogs.com/eu/demo/#/carInfo?q='+inpval
		window.open(url, '_blank')
		
	}
</script>
{% endblock %}
